{% load static %}

<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" />
  <title>Third Axis</title>
  <meta name="description" content="Blueprint: A responsive product grid layout with touch-friendly Flickity galleries and Isotope-powered filter functionality." />
  <meta name="keywords" content="blueprint, template, layout, grid, responsive, products, store, filter, isotope, flickity" />
  <meta name="author" content="Codrops" />
  <link rel="shortcut icon" href="{% static 'favicon.ico' %}">

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap 4  -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <!-- Flaticon icons -->
  <link rel="stylesheet" type="text/css" href="{% static 'font/flaticon.css' %}" />
  <!-- General demo styles & header -->
  <link id="mystylesheet" rel="stylesheet" type="text/css" href="{% static 'css/demo.css' %}" />
  <!-- Flickity gallery styles -->
  <link rel="stylesheet" type="text/css" href="{% static 'css/flickity.css' %}" />

  <script src="{% static 'js/modernizr.custom.js' %}"></script>
  <script type="text/javascript">
    var user = '{{request.user}}'

    function getToken(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          // Does this cookie string begin with the name we want?
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    const csrftoken = getToken('csrftoken');


    function getCookie(name) {
      //Split cookie string and get all individual name=value pairs in array
      var cookieArr = document.cookie.split(";");

      //Loop through the array elements
      for (var i = 0; i < cookieArr.length; i++) {
        var cookiePair = cookieArr[i].split("=");

        /* Removing whitespace at the begining of the cookie name
        and compare it with the given string */
        if (name == cookiePair[0].trim()) {
          // Decode the cookie value and return
          return decodeURIComponent(cookiePair[1]);
        }
      }
      //Return null if not found
      return null;
    }
    console.log('Cart: ', cart)


    var cart = JSON.parse(getCookie('cart'))

    if (cart == undefined) {
      cart = {}
      console.log('Cart Created!', cart)
      document.cookie = 'cart=' + JSON.stringify(cart) + ";domain;path=/"
    }
    console.log('Cart: ', cart)
  </script>
</head>

<body>

  <hr style="color:black">

  <!-- Blueprint header -->
  <header class="bp-header ">

    <span><img id="spinner" src="{% static 'images/III-light.gif' %}" style="width: 5%"/><sup> rd</sup>Axis<span class="bp bp-icon-about" data-content="Ready to eat?"></span></span>

    {% if user.is_authenticated %}
    <h5>Logged in as: {{user.username}}
      <h5>
        <a onclick="darkMode()"><ion-icon title="Dark Mode" name="contrast-outline" ></ion-icon></a>

        <a onclick="lightMode()"><ion-icon title="Light Mode" name="sunny-outline" ></ion-icon></a>



        {% endif %}
        <nav>
          <a href="{% url 'store' %}" title="About Us" ><ion-icon name="information-circle-outline" size="large"></ion-icon></a>
          <a href="{% url 'contact' %}" title="Contact" ><ion-icon name="mail-outline" size="large"></ion-icon></a>
          <a href="{% url 'store' %}" title="Online Store" ><ion-icon name="home-outline" size="large"></ion-icon></a>
          <a href="{% url 'cart' %}"  tile="My Cart"data-info=""><ion-icon name="cart-outline" size="large"></ion-icon></a>
          {% if user.is_authenticated %}
          <a href="{% url 'account:profile' %}" title="My  Profile"><ion-icon name="person-outline" size="large"></ion-icon></a>
          <a href="{% url 'account:logout' %}" title="Log Out"><ion-icon name="log-out-outline" size="large"></ion-icon></a>
          {% else %}
          <a href="{% url 'account:register' %}" title="Create Account"><ion-icon name="person-add-outline" size="large"></ion-icon></a>
          <a href="{% url 'account:login' %}" title="Log in"><ion-icon name="log-in-outline"  size="large"></ion-icon></a>
          {% endif %}

        </nav>
        <hr style="color:black">

  </header>


  <div class="content" id="test">
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-warning alert-dismissable" role="alert">
      <button class="close" data-dismiss="modal"><small><sup>x</sup></small></button>
      {{ message }}
    </div>
    {% endfor %}
    {%  endif %}

    {% block body %}
    {% endblock body %}
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.0/paper-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
    <script src="{% static 'js/isotope.pkgd.min.js' %}"></script>
    <script src="{% static 'js/flickity.pkgd.min.js' %}"></script>
    <script src="{% static 'js/classie.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/cart.js' %}"></script>
    <script src="{% static 'js/demo5.js' %}"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@5.1.2/dist/ionicons/ionicons.js"></script>

    <script type="text/javascript">
    document.addEventListener('mousemove', e=> {

      let bubles = document.createElement('bubles');
      let x = e.pageX;
      let y = e.pageY;
      bubles.style.left = x + "px";
      bubles.style.top = y + "px";
      let size = Math.random() * 100;
      bubles.style.width = 1 + size + "px";
      bubles.style.height = 1 + size + "px";

      document.body.appendChild(bubles);
      setTimeout(function() {
        bubles.remove();
      }, 1100);
    });





    var theme = localStorage.getItem('theme')
    var spinner = localStorage.getItem('spinner')

    console.log("Theme:", theme)
    console.log("Spinner:", spinner)
      if (theme == null){
        lightMode()
      }else{
        document.getElementById('mystylesheet').href = theme

      }


      if (spinner == null){
        lightMode()
      }else{
        document.getElementById('spinner').src = spinner

      }

      function darkMode(){
            console.log("DarkMode Ran")
            swapStyleDark()
            swapImageDark()
          }
              function swapStyleDark(){
                  console.log("Dark Style Ran")
                  document.getElementById('mystylesheet').href = "{% static 'css/demo-dark.css' %}"
                  localStorage.setItem('theme', "{% static 'css/demo-dark.css' %}")
                }

              function swapImageDark(){
                console.log("Dark Image Ran")
                document.getElementById('spinner').src = "{% static 'images/III-dark.gif' }"
                localStorage.setItem('spinner', "{% static 'images/III-dark.gif' %}")

                }

        function lightMode(){
          console.log("Light Mode Ran")
          swapStyleLight()
          swapImageLight()

          }
          function swapStyleLight(){
            console.log("Light Style Ran")
            document.getElementById('mystylesheet').href = "{% static 'css/demo.css' %}"
            localStorage.setItem('theme', "{% static 'css/demo.css' %}")
          }

          function swapImageLight(){
            console.log("Light Image Ran")
            document.getElementById('spinner').src = "{% static 'images/III-light.gif' %}"
            localStorage.setItem('spinner', "{% static 'images/III-light.gif' %}")
          }
        </script>

        <hr style="color:black">
<br><br>

</body>

</html>
